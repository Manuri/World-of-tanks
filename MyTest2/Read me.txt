this version is working but DAMN SLOW. This has a lot of console.writelines. 